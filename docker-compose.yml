version: '3.8'

services:
  backend:
    build: .
    container_name: ultra-ai-backend
    restart: always
    ports:
      - "3001:3001"
    env_file:
      - .env
    volumes:
      - ./browser_data:/app/browser_data  # 持久化浏览器 Cookie 和 Session
      - ./static:/app/static              # 持久化静态文件
      - ./store:/app/store                # 持久化抓取的数据
    healthcheck:
      # 如果 app 没定义 /health，可以用简单的 python 脚本心跳
      test: ["CMD-SHELL", "curl -f http://localhost:3001/ || exit 1"]
      interval: 60s
      timeout: 10s
      retries: 3
